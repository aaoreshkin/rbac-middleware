# RBAC middleware

RBAC расшифровывается как «Role-Based Access Control». Это подход к ограничению доступа к системе для авторизованных пользователей. В системе RBAC права доступа назначаются не непосредственно отдельным пользователям, а ролям, которые могут быть у пользователей. Эти роли представляют собой набор привилегий или прав доступа, которые определяют, какие действия пользователь может выполнять в системе или приложении.

Например, типичные роли в организации могут включать:

`superuser`: Имеет полный доступ ко всем ресурсам и может управлять другими пользователями и их ролями.
`manager`: Имеет доступ к определенному набору ресурсов, необходимых для выполнения своих должностных обязанностей.
`guest`: Имеет очень ограниченный доступ, например, доступ к публичной информации только для чтения.

RBAC позволяет администраторам легче управлять доступом к системе, назначая и переназначая роли, а не устанавливая разрешения для каждого пользователя в отдельности. Это делает модель масштабируемой и гибкой, особенно в крупных организациях.

### Роли

- `superuser` – Разрешает доступ к чтению, изменению и удалению.
- `manager` – Разрешает доступ к чтению и изменению.
- `guest` – Разрешает доступ к чтению определенных ресурсов.
  ...

### Особенности

- Аутентификация на основе JWT
- Контроль доступа на основе ролей
- Настраиваемый ролевой ключ для JWT
- Дженерики

## Установка

Чтобы установить библиотеку, выполните следующую команду:

```bash
go get -u github.com/oreshkindev/rbac-middleware
```

### Использование

Импортируйте библиотеку:

```go
import (
    "github.com/oreshkindev/rbac-middleware"
)
```

Настройте секретный ключ для JWT:

```go
os.Setenv("SECRET_KEY", "ваш секретный ключ")
```

или используйте окружение .env.sh

```bash
export SECRET_KEY="ваш секретный ключ"
```

или доверьтесь openssl

```bash
export SECRET_KEY="$(openssl rand -base64 32)"
```

Определите роли:

```go
const (
	superuser rbac.Access = "superuser"
	manager   rbac.Access = "manager"
	guest   rbac.Access = "guest"
)
```

или

```go
const (
    superuser rbac.Access = iota + 1
    manager
    guest
)
```

Используй мидлварь в своем HTTP хендлере:

```go
http.Handle("/lk", rbac.Guard([]string{"superuser", "manager"})(ваш хендлер))
```

Создание токена:

Ключ `role` - это условность. Он может быть любым на ваше усмотрение.

```go
token, err := rbac.HashToken(map[string]interface{}{"role": "superuser"}, 24*time.Hour)
```

Получение роли:

```go
role, err := rbac.GetRole[string](token)
```
